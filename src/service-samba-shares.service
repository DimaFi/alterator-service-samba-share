type = "Service"
name = "service_samba_shares"
category = "X-Alterator-Servers"

display_name.en = "Samba Shares"
display_name.ru = "Общие папки Samba"

comment.en = "For managing Samba shares"
comment.ru = "Для управления общими папками Samba"

enable_force_deploy = true
no_default_diag = true

# -------- STATUS: список шар ----------
[parameters.shares]
display_name.en = "Samba Shares"
display_name.ru = "Общие папки Samba"
type = "array"
array_type = "object"
context = ["status"]
required = ["status"]

[parameters.shares.properties.share_name]
display_name.en = "Share Name"
display_name.ru = "Имя общей папки"
type = "string"

[parameters.shares.properties.share_path]
display_name.en = "Share Path"
display_name.ru = "Путь к папке"
type = "string"

[parameters.shares.properties.access_user]
display_name.en = "Access User"
display_name.ru = "Пользователь"
type = "string"

[parameters.shares.properties.access_type]
display_name.en = "Access Type"
display_name.ru = "Тип доступа"
type = "enum"
default = "ro"
[parameters.shares.properties.access_type.values.ro]
display_name.en = "Read-only"
display_name.ru = "Только чтение"
[parameters.shares.properties.access_type.values.rw]
display_name.en = "Read/Write"
display_name.ru = "Чтение и запись"

[parameters.shares.properties.enabled]
display_name.en = "Enabled"
display_name.ru = "Включена"
type = "boolean"
default = true

[parameters.shares.properties.allowed_users]
display_name.en = "Allowed Users"
display_name.ru = "Разрешённые пользователи"
type = "string"

# -------- Operation selector ----------
[parameters.operation]
display_name.en = "Choice operation"
display_name.ru = "Выбор операции"
comment.en = "Pick one: Create, Update or Delete"
comment.ru = "Выберите одно: Создать, Изменить или Удалить"
type = "enum"
default = "create"
context = ["configure"]

[parameters.operation.values.create]
display_name.en = "Create"
display_name.ru = "Создать"
[parameters.operation.values.update]
display_name.en = "Update"
display_name.ru = "Изменить"
[parameters.operation.values.delete]
display_name.en = "Delete"
display_name.ru = "Удалить"

# -------- CREATE section ----------
[parameters.create]
display_name.en = "Create new share"
display_name.ru = "Создать новую шару"
comment.en = "Required: name, path, owner, access type"
comment.ru = "Обязательно: имя, путь, владелец, тип доступа"
type = "object"
context = ["configure"]

[parameters.create.properties.share_name]
display_name.en = "Share Name"
display_name.ru = "Имя общей папки"
comment.en = "Unique name of the Samba share"
comment.ru = "Уникальное имя общей папки Samba"
type = "string"

[parameters.create.properties.share_path]
display_name.en = "Share Path"
display_name.ru = "Путь к папке"
comment.en = "Filesystem path to the shared folder"
comment.ru = "Путь к каталогу, который будет расшарен"
type = "string"

[parameters.create.properties.access_user]
display_name.en = "Owner (Access User)"
display_name.ru = "Владелец (Пользователь)"
comment.en = "User who will own the folder and have access"
comment.ru = "Пользователь, которому принадлежит папка и который имеет доступ"
type = "string"

[parameters.create.properties.access_type]
display_name.en = "Access Type"
display_name.ru = "Тип доступа"
comment.en = "Access permission: read-only (ro) or read-write (rw)"
comment.ru = "Тип доступа: только чтение (ro) или чтение и запись (rw)"
type = "enum"
default = "ro"
[parameters.create.properties.access_type.values.ro]
display_name.en = "Read-only"
display_name.ru = "Только чтение"
[parameters.create.properties.access_type.values.rw]
display_name.en = "Read/Write"
display_name.ru = "Чтение и запись"

[parameters.create.properties.allowed_users]
display_name.en = "Allowed Users (comma-separated)"
display_name.ru = "Разрешённые пользователи (через запятую)"
comment.en = "Comma-separated list of users allowed to access this share"
comment.ru = "Список пользователей с доступом к этой расшаренной папке (через запятую)"
type = "string"

# -------- UPDATE section ----------
[parameters.update]
display_name.en = "Update existing share"
display_name.ru = "Изменить существующую шару"
comment.en = "Required: name. Fill only fields you want to change."
comment.ru = "Обязательно: имя. Заполняйте только то, что нужно изменить."
type = "object"
context = ["configure"]

[parameters.update.properties.share_name]
display_name.en = "Share Name (required)"
display_name.ru = "Имя общей папки (обязательно)"
comment.en = "Unique name of the Samba share"
comment.ru = "Уникальное имя общей папки Samba"
type = "string"

[parameters.update.properties.share_path]
display_name.en = "New Share Path"
display_name.ru = "Новый путь к папке"
comment.en = "Filesystem path to the shared folder"
comment.ru = "Путь к каталогу, который будет расшарен"
type = "string"

[parameters.update.properties.access_user]
display_name.en = "New Owner (Access User)"
display_name.ru = "Новый владелец (Пользователь)"
comment.en = "User who will own the folder and have access"
comment.ru = "Пользователь, которому принадлежит папка и который имеет доступ"
type = "string"

[parameters.update.properties.access_type]
display_name.en = "New Access Type"
display_name.ru = "Новый тип доступа"
comment.en = "Access permission: read-only (ro) or read-write (rw)"
comment.ru = "Тип доступа: только чтение (ro) или чтение и запись (rw)"
type = "enum"
[parameters.update.properties.access_type.values.ro]
display_name.en = "Read-only"
display_name.ru = "Только чтение"
[parameters.update.properties.access_type.values.rw]
display_name.en = "Read/Write"
display_name.ru = "Чтение и запись"

[parameters.update.properties.allowed_users]
display_name.en = "New Allowed Users (comma-separated)"
display_name.ru = "Новые разрешённые пользователи (через запятую)"
comment.en = "Comma-separated list of users allowed to access this share"
comment.ru = "Список пользователей с доступом к этой расшаренной папке (через запятую)"
type = "string"

[parameters.update.properties.delete_prev_allowed]
display_name.en = "Delete previous allowed users"
display_name.ru = "Удалить прежних разрешённых"
comment.en = "If enabled, replace previous allowed users with the new list. If disabled, merge new users with existing."
comment.ru = "Если включено — заменить прежних разрешённых новым списком. Если выключено — добавить новых к существующим."
type = "boolean"
default = false


# -------- DELETE section ----------
[parameters.delete]
display_name.en = "Delete share"
display_name.ru = "Удалить шару"
comment.en = "Required: name"
comment.ru = "Обязательно: имя"
type = "object"
context = ["configure"]

[parameters.delete.properties.share_name]
display_name.en = "Share Name (required)"
display_name.ru = "Имя общей папки (обязательно)"
comment.en = "Unique name of the Samba share"
comment.ru = "Уникальное имя общей папки Samba"
type = "string"

# ---------------- Resources ----------------
[resources.smb_conf]
display_name.en = "Samba Configuration File"
display_name.ru = "Конфигурационный файл Samba"
type = "file"
path.value = "/etc/samba/smb.conf"

[resources.backups]
display_name.en = "Samba Backup Recovery files"
display_name.ru = "Файлы резервного восстанавления Samba"
type = "file"
path.value = "/etc/samba/backups"

[resources.smb_service]
display_name.en = "Samba service"
display_name.ru = "Сервис Samba"
type = "systemd_unit"
unit_name.value = "smb.service"

[resources.nmb_service]
display_name.en = "NetBIOS service"
display_name.ru = "Сервис NetBIOS"
type = "systemd_unit"
unit_name.value = "nmb.service"



# ------------------Backup Restore---------------
[parameters.backup_name]
display_name.ru = "Имя файла бэкапа"
display_name.en = "Backup filename"
comment.ru = "Оставьте пустым для автоматического имени"
comment.en = "Leave empty to use autogenerated filename"
type = "string"
context = ["restore", "backup"]